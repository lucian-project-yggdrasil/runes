{"version":3,"sources":["../../src/social/index.ts","../../src/social/logic.ts","../../src/social/schemas.ts"],"sourcesContent":["export * from \"./logic.js\"\nexport * from \"./schemas.js\"\n","import { DateTime } from \"luxon\"\nimport type { Frequency, Friend, RelationshipStatus } from \"./schemas\"\n\nconst FREQUENCY_DAYS: Record<Frequency, number> = {\n\tweekly: 7,\n\tmonthly: 30,\n\tquarterly: 90,\n\tyearly: 365,\n\t\"ad-hoc\": 9999,\n}\n\n/**\n * Calculates the health of a relationship based on frequency targets.\n */\nexport const getRelationshipStatus = (friend: Friend): RelationshipStatus => {\n\t// Unknown / New\n\tif (!friend.lastContactedAt) return \"unknown\"\n\n\t// Ad-hoc (Never decays)\n\tif (friend.targetFrequency === \"ad-hoc\") return \"healthy\"\n\n\tconst lastContact = DateTime.fromISO(friend.lastContactedAt)\n\tconst now = DateTime.now()\n\tconst daysSince = Math.floor(now.diff(lastContact, \"days\").days)\n\tconst target = FREQUENCY_DAYS[friend.targetFrequency]\n\n\tif (daysSince <= target) return \"healthy\"\n\tif (daysSince <= target * 1.5) return \"decaying\" // Grace Period\n\treturn \"critical\"\n}\n","import { z } from \"zod\"\n\n// --- ENUMS ---\nexport const FrequencySchema = z.enum([\n\t\"weekly\", // 7 days\n\t\"monthly\", // 30 days\n\t\"quarterly\", // 90 days\n\t\"yearly\", // 365 days\n\t\"ad-hoc\", // No pressure\n])\nexport const RelationshipStatusSchema = z.enum([\"healthy\", \"decaying\", \"critical\", \"unknown\"])\n\n// --- SUB-MODELS ---\nexport const InteractionSchema = z.object({\n\tid: z.uuid(),\n\tdate: z.iso.datetime(), // ISO 8601\n\ttype: z.enum([\"call\", \"text\", \"meet\", \"social\", \"email\"]),\n\tnotes: z.string().optional(),\n})\n\n// --- MAIN MODEL ---\nexport const FriendSchema = z.object({\n\tid: z.uuid().optional(),\n\tname: z.string().min(1, \"Name is required\"),\n\temail: z.email().optional(),\n\tavatarUrl: z.url().optional(),\n\n\ttier: z.enum([\"inner\", \"outer\", \"network\"]).default(\"network\"),\n\ttargetFrequency: FrequencySchema.default(\"monthly\"),\n\tlastContactedAt: z.iso.datetime().optional(),\n\n\tbirthday: z\n\t\t.string()\n\t\t.regex(/^\\d{2}-\\d{2}$/, \"Format MM-DD\")\n\t\t.optional(),\n\ttags: z.array(z.string()).default([]),\n\tinteractions: z.array(InteractionSchema).default([]),\n})\n\nexport type Frequency = z.infer<typeof FrequencySchema>\nexport type RelationshipStatus = z.infer<typeof RelationshipStatusSchema>\nexport type Interaction = z.infer<typeof InteractionSchema>\nexport type Friend = z.infer<typeof FriendSchema>\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,mBAAyB;AAGzB,IAAM,iBAA4C;AAAA,EACjD,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,UAAU;AACX;AAKO,IAAM,wBAAwB,CAAC,WAAuC;AAE5E,MAAI,CAAC,OAAO,gBAAiB,QAAO;AAGpC,MAAI,OAAO,oBAAoB,SAAU,QAAO;AAEhD,QAAM,cAAc,sBAAS,QAAQ,OAAO,eAAe;AAC3D,QAAM,MAAM,sBAAS,IAAI;AACzB,QAAM,YAAY,KAAK,MAAM,IAAI,KAAK,aAAa,MAAM,EAAE,IAAI;AAC/D,QAAM,SAAS,eAAe,OAAO,eAAe;AAEpD,MAAI,aAAa,OAAQ,QAAO;AAChC,MAAI,aAAa,SAAS,IAAK,QAAO;AACtC,SAAO;AACR;;;AC7BA,iBAAkB;AAGX,IAAM,kBAAkB,aAAE,KAAK;AAAA,EACrC;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AACD,CAAC;AACM,IAAM,2BAA2B,aAAE,KAAK,CAAC,WAAW,YAAY,YAAY,SAAS,CAAC;AAGtF,IAAM,oBAAoB,aAAE,OAAO;AAAA,EACzC,IAAI,aAAE,KAAK;AAAA,EACX,MAAM,aAAE,IAAI,SAAS;AAAA;AAAA,EACrB,MAAM,aAAE,KAAK,CAAC,QAAQ,QAAQ,QAAQ,UAAU,OAAO,CAAC;AAAA,EACxD,OAAO,aAAE,OAAO,EAAE,SAAS;AAC5B,CAAC;AAGM,IAAM,eAAe,aAAE,OAAO;AAAA,EACpC,IAAI,aAAE,KAAK,EAAE,SAAS;AAAA,EACtB,MAAM,aAAE,OAAO,EAAE,IAAI,GAAG,kBAAkB;AAAA,EAC1C,OAAO,aAAE,MAAM,EAAE,SAAS;AAAA,EAC1B,WAAW,aAAE,IAAI,EAAE,SAAS;AAAA,EAE5B,MAAM,aAAE,KAAK,CAAC,SAAS,SAAS,SAAS,CAAC,EAAE,QAAQ,SAAS;AAAA,EAC7D,iBAAiB,gBAAgB,QAAQ,SAAS;AAAA,EAClD,iBAAiB,aAAE,IAAI,SAAS,EAAE,SAAS;AAAA,EAE3C,UAAU,aACR,OAAO,EACP,MAAM,iBAAiB,cAAc,EACrC,SAAS;AAAA,EACX,MAAM,aAAE,MAAM,aAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACpC,cAAc,aAAE,MAAM,iBAAiB,EAAE,QAAQ,CAAC,CAAC;AACpD,CAAC;","names":[]}